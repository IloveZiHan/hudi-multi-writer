package cn.com.multi_writer.meta

import org.apache.spark.sql.types.{DataType, StructType}

object SchemaJsonParse {
  def main(args: Array[String]): Unit = {
    val schema = """{"type":"struct","fields":[{"metadata":{"comment":"物理主键"},"name":"id","type":"string","nullable":true},{"metadata":{"comment":"借据号"},"name":"loan_no","type":"string","nullable":true},{"metadata":{"comment":"合同号"},"name":"cont_no","type":"string","nullable":true},{"metadata":{"comment":"客户编号"},"name":"cust_no","type":"string","nullable":true},{"metadata":{"comment":"客户姓名"},"name":"cust_name","type":"string","nullable":true},{"metadata":{"comment":"证件类型"},"name":"id_type","type":"string","nullable":true},{"metadata":{"comment":"证件号码"},"name":"id_no","type":"string","nullable":true},{"metadata":{"comment":"产品编号"},"name":"prod_no","type":"string","nullable":true},{"metadata":{"comment":"产品ID"},"name":"prod_id","type":"string","nullable":true},{"metadata":{"comment":"交易日期"},"name":"trade_dt","type":"string","nullable":true},{"metadata":{"comment":"借据状态"},"name":"loan_sts","type":"string","nullable":true},{"metadata":{"comment":"起息日"},"name":"int_start_dt","type":"string","nullable":true},{"metadata":{"comment":"贷款期限"},"name":"loan_term","type":"integer","nullable":true},{"metadata":{"comment":"到期日"},"name":"due_dt","type":"string","nullable":true},{"metadata":{"comment":"还款日"},"name":"repay_dt","type":"integer","nullable":true},{"metadata":{"comment":"还款间隔单位"},"name":"repay_intrv_unit","type":"string","nullable":true},{"metadata":{"comment":"还款间隔"},"name":"repay_intrv","type":"integer","nullable":true},{"metadata":{"comment":"还款方式代码"},"name":"repay_mode_code","type":"string","nullable":true},{"metadata":{"comment":"期供标志"},"name":"instm_ind","type":"string","nullable":true},{"metadata":{"comment":"贷款期数"},"name":"loan_tnr","type":"integer","nullable":true},{"metadata":{"comment":"借据账务状态"},"name":"loan_account_sts","type":"string","nullable":true},{"metadata":{"comment":"第一次扣款日"},"name":"fst_repay_dt","type":"string","nullable":true},{"metadata":{"comment":"上次还款日"},"name":"last_repay_dt","type":"string","nullable":true},{"metadata":{"comment":"当前还款日"},"name":"curr_repay_dt","type":"string","nullable":true},{"metadata":{"comment":"下一还款日"},"name":"next_repay_dt","type":"string","nullable":true},{"metadata":{"comment":"五级分类编码"},"name":"five_lvl_class_code","type":"string","nullable":true},{"metadata":{"comment":"执行利率"},"name":"int_rate","type":"decimal","nullable":true},{"metadata":{"comment":"罚息利率"},"name":"od_int_rate","type":"decimal","nullable":true},{"metadata":{"comment":"贷款金额"},"name":"loan_amt","type":"decimal","nullable":true},{"metadata":{"comment":"贷款余额"},"name":"loan_bal","type":"decimal","nullable":true},{"metadata":{"comment":"核销日期"},"name":"wrtoff_dt","type":"string","nullable":true},{"metadata":{"comment":"宽限期类型"},"name":"grace_perd_type","type":"string","nullable":true},{"metadata":{"comment":"宽限期天数"},"name":"grace_perd_days","type":"integer","nullable":true},{"metadata":{"comment":"计算罚息部分"},"name":"calc_od_int_part","type":"string","nullable":true},{"metadata":{"comment":"贷款拖欠标志"},"name":"loan_deflt_ind","type":"string","nullable":true},{"metadata":{"comment":"上次计提日"},"name":"last_provi_dt","type":"string","nullable":true},{"metadata":{"comment":"上次转逾期日"},"name":"last_tran_over_dte","type":"string","nullable":true},{"metadata":{"comment":"上一次扣款日"},"name":"last_deduct_dt","type":"string","nullable":true},{"metadata":{"comment":"当前结违约金日期"},"name":"curr_jon_penal_fee_dt","type":"string","nullable":true},{"metadata":{"comment":"当前结罚息日期"},"name":"curr_jon_od_int_dt","type":"string","nullable":true},{"metadata":{"comment":"上次计提罚息日期"},"name":"last_provi_od_int_dt","type":"string","nullable":true},{"metadata":{"comment":"贷款减值标志"},"name":"loan_deval_ind","type":"string","nullable":true},{"metadata":{"comment":"贷款减值日期"},"name":"loan_deval_dt","type":"string","nullable":true},{"metadata":{"comment":"转表外标志"},"name":"tran_off_bs_ind","type":"string","nullable":true},{"metadata":{"comment":"转表外日期"},"name":"tran_off_bs_dt","type":"string","nullable":true},{"metadata":{"comment":"原到期日"},"name":"ori_due_dt","type":"string","nullable":true},{"metadata":{"comment":"增值税税率"},"name":"vat_tax_rate","type":"decimal","nullable":true},{"metadata":{"comment":"借据锁定状态"},"name":"loan_lock_sts","type":"string","nullable":true},{"metadata":{"comment":"减值还款顺序"},"name":"deval_repay_seq","type":"string","nullable":true},{"metadata":{"comment":"项目协议编号"},"name":"coopr_cont_no","type":"string","nullable":true},{"metadata":{"comment":"代还款标志"},"name":"agent_repay_ind","type":"string","nullable":true},{"metadata":{"comment":"延迟支付标志"},"name":"delay_pay_ind","type":"string","nullable":true},{"metadata":{"comment":"合作方业务流水"},"name":"coopr_biz_seq","type":"string","nullable":true},{"metadata":{"comment":"进件渠道"},"name":"chan_no","type":"string","nullable":true},{"metadata":{"comment":"收益类型"},"name":"prft_type","type":"string","nullable":true},{"metadata":{"comment":"日利率天数计算基础：360/365"},"name":"day_rate_calc_base","type":"string","nullable":true},{"metadata":{"comment":"尾期是否补差: Y-是、N-否"},"name":"last_sub","type":"string","nullable":true},{"metadata":{"comment":"账务机构"},"name":"account_org","type":"string","nullable":true},{"metadata":{"comment":"创建时间"},"name":"create_time","type":"timestamp","nullable":true},{"metadata":{"comment":"创建人"},"name":"create_user","type":"string","nullable":true},{"metadata":{"comment":"修改时间"},"name":"update_time","type":"timestamp","nullable":true},{"metadata":{"comment":"修改人"},"name":"update_user","type":"string","nullable":true},{"metadata":{"comment":"逻辑删标志"},"name":"del_flag","type":"string","nullable":true},{"metadata":{"comment":"风险认定五级分类编码"},"name":"risk_five_lvl_class_code","type":"string","nullable":true},{"metadata":{"comment":"联合贷标志 Y-是,N-否"},"name":"unite_crdt_ind","type":"string","nullable":true},{"metadata":{"comment":"我方出资比例"},"name":"our_pty_contri_ratio","type":"decimal","nullable":true},{"metadata":{"comment":"承保标志"},"name":"insure_ind","type":"string","nullable":true},{"metadata":{"comment":"借据余额积数"},"name":"loan_bal_accum","type":"decimal","nullable":true},{"metadata":{"comment":"资产池编号"},"name":"portfolio_code","type":"string","nullable":true},{"metadata":{"comment":"终止确认类型（Y出表，N不出表）"},"name":"confirmation_type","type":"string","nullable":true},{"metadata":{"comment":"放款类型"},"name":"fund_type","type":"string","nullable":true},{"metadata":{"comment":"账单分期借据号"},"name":"amort_loan_no","type":"string","nullable":true},{"metadata":{"comment":"综合年化利率"},"name":"comb_rate","type":"decimal","nullable":true}]}"""

    val rebuiltSchema = DataType.fromJson(schema).asInstanceOf[StructType]
    rebuiltSchema.printTreeString()
    println(s"重新构建的 Schema 字段数: ${rebuiltSchema.fields.length}")
      
  }

}
