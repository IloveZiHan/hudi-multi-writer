# Hudi Multi Writer

ä¸€ä¸ªåŸºäºApache Hudiçš„å¤šå†™å…¥å™¨é¡¹ç›®ï¼Œç°åœ¨åŒ…å«å®Œæ•´çš„Webç®¡ç†ç³»ç»Ÿã€‚

## é¡¹ç›®ç»“æ„

```
hudi-multi-writer/
â”œâ”€â”€ spark-hudi-multi-writer/    # åŸæœ‰çš„Sparkå¤šå†™å…¥å™¨æ¨¡å—
â”œâ”€â”€ hudi-meta-service/          # æ–°å¢ï¼šä¸šåŠ¡æœåŠ¡å±‚
â”œâ”€â”€ hudi-meta-web/              # æ–°å¢ï¼šWeb APIå±‚
â”œâ”€â”€ hudi-meta-frontend/         # æ–°å¢ï¼šå‰ç«¯ç®¡ç†ç•Œé¢
â”œâ”€â”€ hudi-meta-service/          # å…ƒæ•°æ®æœåŠ¡
â”œâ”€â”€ hudi-meta-web/              # WebæœåŠ¡
â”œâ”€â”€ pom.xml                     # Mavençˆ¶é¡¹ç›®é…ç½®
â””â”€â”€ README.md                   # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

## ğŸš€ æ–°å¢åŠŸèƒ½

### 1. Webç®¡ç†ç³»ç»Ÿ

- **å‰ç«¯ç•Œé¢**ï¼šåŸºäºReact + TypeScript + Ant Design
- **åç«¯API**ï¼šåŸºäºSpring Boot + Scala
- **åŠŸèƒ½ç‰¹æ€§**ï¼š
  - è¡¨çš„å¢åˆ æ”¹æŸ¥ç®¡ç†
  - æ‰¹é‡æ“ä½œï¼ˆä¸Šçº¿ã€ä¸‹çº¿ã€åˆ é™¤ï¼‰
  - é«˜çº§æœç´¢å’Œè¿‡æ»¤
  - æ•°æ®ç»Ÿè®¡å’Œå¯è§†åŒ–
  - è¡¨è¯¦æƒ…æŸ¥çœ‹å’Œç¼–è¾‘
  - æ•°æ®å¯¼å‡ºåŠŸèƒ½

### 2. æŠ€æœ¯æ ˆ

#### åç«¯
- **Spring Boot 2.7.14**ï¼šWebæ¡†æ¶
- **Scala 2.12.18**ï¼šç¼–ç¨‹è¯­è¨€
- **Apache Spark 3.5.0**ï¼šå¤§æ•°æ®å¤„ç†
- **Apache Hudi 0.15.0**ï¼šæ¹–ä»“ä¸€ä½“åŒ–å­˜å‚¨
- **Jackson**ï¼šJSONåºåˆ—åŒ–
- **Bean Validation**ï¼šæ•°æ®éªŒè¯

#### å‰ç«¯
- **React 18.2.0**ï¼šå‰ç«¯æ¡†æ¶
- **TypeScript 5.2.2**ï¼šç±»å‹å®‰å…¨
- **Ant Design 5.12.1**ï¼šUIç»„ä»¶åº“
- **Vite 5.0.0**ï¼šæ„å»ºå·¥å…·
- **Axios 1.6.2**ï¼šHTTPå®¢æˆ·ç«¯
- **React Router 6.20.1**ï¼šè·¯ç”±ç®¡ç†
- **Dayjs 1.11.10**ï¼šæ—¶é—´å¤„ç†

## ğŸ› ï¸ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Java 8+
- Maven 3.6+
- Node.js 16+
- npm 7+

### 1. åç«¯å¯åŠ¨

```bash
# è¿›å…¥é¡¹ç›®æ ¹ç›®å½•
cd hudi-multi-writer

# ç¼–è¯‘æ•´ä¸ªé¡¹ç›®
mvn clean compile

# å¯åŠ¨WebæœåŠ¡
cd hudi-meta-web
mvn spring-boot:run
```

æœåŠ¡å¯åŠ¨åï¼Œè®¿é—®ï¼š`http://localhost:8080`

### 2. å‰ç«¯å¯åŠ¨

```bash
# è¿›å…¥å‰ç«¯ç›®å½•
cd hudi-meta-frontend

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

å‰ç«¯å¯åŠ¨åï¼Œè®¿é—®ï¼š`http://localhost:3000`

### 3. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

#### åç«¯éƒ¨ç½²

```bash
# æ„å»ºJARåŒ…
mvn clean package -DskipTests

# è¿è¡ŒJARåŒ…
java -jar hudi-meta-web/target/hudi-meta-web-1.0.0.jar --spring.profiles.active=prod
```

#### å‰ç«¯éƒ¨ç½²

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# éƒ¨ç½²åˆ°WebæœåŠ¡å™¨
# å°†distç›®å½•çš„å†…å®¹éƒ¨ç½²åˆ°nginxæˆ–å…¶ä»–WebæœåŠ¡å™¨
```

## ğŸ“š APIæ–‡æ¡£

### ä¸»è¦APIç«¯ç‚¹

| æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|
| GET | `/api/v1/tables` | è·å–æ‰€æœ‰è¡¨ï¼ˆåˆ†é¡µï¼‰ |
| GET | `/api/v1/tables/{id}` | è·å–è¡¨è¯¦æƒ… |
| POST | `/api/v1/tables` | åˆ›å»ºæ–°è¡¨ |
| PUT | `/api/v1/tables/{id}` | æ›´æ–°è¡¨ä¿¡æ¯ |
| DELETE | `/api/v1/tables/{id}` | åˆ é™¤è¡¨ |
| POST | `/api/v1/tables/search` | é«˜çº§æœç´¢ |
| POST | `/api/v1/tables/batch` | æ‰¹é‡æ“ä½œ |
| GET | `/api/v1/tables/stats` | è·å–ç»Ÿè®¡ä¿¡æ¯ |
| PUT | `/api/v1/tables/{id}/online` | è¡¨ä¸Šçº¿ |
| PUT | `/api/v1/tables/{id}/offline` | è¡¨ä¸‹çº¿ |

### è¯·æ±‚ç¤ºä¾‹

```bash
# è·å–æ‰€æœ‰è¡¨
curl -X GET "http://localhost:8080/api/v1/tables?page=0&size=10"

# åˆ›å»ºæ–°è¡¨
curl -X POST "http://localhost:8080/api/v1/tables" \
  -H "Content-Type: application/json" \
  -d '{
    "id": "test_table",
    "schema": "CREATE TABLE test_table (id INT, name STRING)",
    "status": 0,
    "isPartitioned": false
  }'
```

## ğŸ”§ é…ç½®è¯´æ˜

### åç«¯é…ç½®

ä¸»è¦é…ç½®æ–‡ä»¶ï¼š`hudi-meta-web/src/main/resources/application.yml`

```yaml
# æœåŠ¡ç«¯å£
server:
  port: 8080

# Sparké…ç½®
spark:
  app:
    name: "Hudi Meta Web"
  master: "local[*]"

# Hudié…ç½®
hudi:
  meta:
    table:
      path: "/tmp/hudi_tables/meta_hudi_table"
```

### å‰ç«¯é…ç½®

ä¸»è¦é…ç½®æ–‡ä»¶ï¼š`hudi-meta-frontend/vite.config.ts`

```typescript
// APIä»£ç†é…ç½®
proxy: {
  '/api': {
    target: 'http://localhost:8080',
    changeOrigin: true,
    secure: false,
  },
}
```

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### 1. è¡¨ç®¡ç†åŠŸèƒ½

- âœ… åˆ›å»ºè¡¨ï¼šæ”¯æŒè‡ªå®šä¹‰schemaå’Œé…ç½®
- âœ… æŸ¥çœ‹è¡¨ï¼šè¯¦ç»†ä¿¡æ¯å±•ç¤ºå’Œåˆ—è¡¨æŸ¥çœ‹
- âœ… ç¼–è¾‘è¡¨ï¼šä¿®æ”¹è¡¨é…ç½®å’Œå±æ€§
- âœ… åˆ é™¤è¡¨ï¼šå®‰å…¨åˆ é™¤ç¡®è®¤
- âœ… æ‰¹é‡æ“ä½œï¼šæ‰¹é‡åˆ é™¤ã€ä¸Šçº¿ã€ä¸‹çº¿
- âœ… æœç´¢è¿‡æ»¤ï¼šå¤šæ¡ä»¶æœç´¢å’Œé«˜çº§è¿‡æ»¤

### 2. æ•°æ®ç»Ÿè®¡

- âœ… è¡¨æ•°é‡ç»Ÿè®¡
- âœ… çŠ¶æ€åˆ†å¸ƒç»Ÿè®¡
- âœ… åˆ†åŒºè¡¨ç»Ÿè®¡
- âœ… å®æ—¶æ•°æ®æ›´æ–°

### 3. ç”¨æˆ·ä½“éªŒ

- âœ… å“åº”å¼è®¾è®¡
- âœ… å›½é™…åŒ–æ”¯æŒï¼ˆä¸­æ–‡ï¼‰
- âœ… é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º
- âœ… åŠ è½½çŠ¶æ€å’Œè¿›åº¦æç¤º
- âœ… æ“ä½œç¡®è®¤å’Œå›æ»š

## ğŸ› é—®é¢˜æ’æŸ¥

### å¸¸è§é—®é¢˜

1. **åç«¯å¯åŠ¨å¤±è´¥**
   - æ£€æŸ¥Javaç‰ˆæœ¬å’ŒMavené…ç½®
   - ç¡®è®¤ç«¯å£8080æœªè¢«å ç”¨
   - æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ï¼š`logs/hudi-meta-web.log`

2. **å‰ç«¯æ— æ³•è®¿é—®åç«¯**
   - æ£€æŸ¥ä»£ç†é…ç½®
   - ç¡®è®¤åç«¯æœåŠ¡å·²å¯åŠ¨
   - æ£€æŸ¥ç½‘ç»œè¿æ¥

3. **æ•°æ®ä¸æ˜¾ç¤º**
   - æ£€æŸ¥Sparké…ç½®
   - ç¡®è®¤Hudiè¡¨è·¯å¾„æ­£ç¡®
   - æŸ¥çœ‹åç«¯æ—¥å¿—

### æ—¥å¿—æŸ¥çœ‹

```bash
# åç«¯æ—¥å¿—
tail -f logs/hudi-meta-web.log

# å‰ç«¯æ§åˆ¶å°
# æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹Console
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»ºPull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨Apache License 2.0è®¸å¯è¯ã€‚

## ğŸ“ è”ç³»æˆ‘ä»¬

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤Issueæˆ–è”ç³»é¡¹ç›®ç»´æŠ¤è€…ã€‚

---

**æ³¨æ„**ï¼šè¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹é¡¹ç›®ï¼Œç”Ÿäº§ç¯å¢ƒä½¿ç”¨å‰è¯·è¿›è¡Œå……åˆ†çš„æµ‹è¯•å’Œå®‰å…¨è¯„ä¼°ã€‚
